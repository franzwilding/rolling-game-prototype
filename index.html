<!doctype html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>rolling</title>
    <meta name="description" content="">
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,600" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style type="text/css">
      body {
        padding: 0;
        margin: 0;
        height: 100vh;
        width: 100vw;
        font-family: 'Open Sans', sans-serif;
      }

      .scroll {
        position: relative;
        height: 100vh;
        width: 100vw;
        overflow: scroll;
      }

      svg {
        position: absolute;
        background: #fefefe;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }

      svg circle.ball {
        cursor: pointer;
      }

      svg.open circle.ball {
        opacity: 0.25;
      }

      #overlay {
        position: fixed;
        width: 50%;
        top: 0;
        right: 0;
        bottom: 0;
        background: #FFFFFF;
        box-shadow: -5px 0 20px 0 rgba(0,0,0,0.10);
        font-weight: 300;
        padding: 50px;
        box-sizing: border-box;
        overflow: auto;
        right: -50%;
        opacity: 0;
        transition: all 0.25s ease-out;
      }

      #overlay.open {
        right: 0;
        opacity: 1;
      }

      #overlay h2 {
        color: #333;
      }

      #overlay p {
        line-height: 200%;
        color: #999;
      }

      #overlay .close {
        display: block;
        width: 50px;
        height: 50px;
        position: absolute;
        right: 20px;
        top: 20px;
        border: none;
        background: none;
        outline: none;
        padding: 0;
        cursor: pointer;
      }

      #overlay .close:before,
      #overlay .close:after {
        width: 2px;
        background: #999;
        display: block;
        content: "";
        position: absolute;
        transform-origin: center center;
        height: 30px;
        transform: rotate(45deg);
        left: 50%;
        top: 50%;
        margin: -15px -15px 0 0;
      }

      #overlay .close:after {
        transform: rotate(-45deg);
      }

    </style>
    <!--script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha256-k2WSCIexGzOj3Euiig+TlR8gA0EmPjuc79OEeY5L45g=" crossorigin="anonymous"></script-->
</head>
<body>
  <div class="scroll">
    <svg id="canvas" width="100%" height="100%" viewBox="0 0 100 100"></svg>
  </div>
  <div id="overlay">
    <h2>Freier Hochschulzugang</h2>

    <p>Bacon ipsum dolor amet ball tip ground round turkey flank tongue. Drumstick sausage meatloaf flank meatball. Jerky meatball ham, prosciutto bacon pancetta leberkas picanha andouille pork chop capicola chuck venison flank shankle. Meatloaf shankle bacon ribeye.</p>

    <p>Tenderloin alcatra ball tip tail frankfurter chuck jowl leberkas. Spare ribs pork loin jowl ham hock bresaola flank short loin pork kevin corned beef tenderloin shoulder ham alcatra. Chicken beef landjaeger rump meatloaf kielbasa ball tip turducken. Venison turducken porchetta shankle, jerky pancetta filet mignon.</p>

    <button onclick="closeOverlay();" class="close"></button>
  </div>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
  <script type="text/javascript">

      EasingFunctions = {
        // no easing, no acceleration
        linear: function (t) { return t },
        // accelerating from zero velocity
        easeInQuad: function (t) { return t*t },
        // decelerating to zero velocity
        easeOutQuad: function (t) { return t*(2-t) },
        // acceleration until halfway, then deceleration
        easeInOutQuad: function (t) { return t<.5 ? 2*t*t : -1+(4-2*t)*t },
        // accelerating from zero velocity
        easeInCubic: function (t) { return t*t*t },
        // decelerating to zero velocity
        easeOutCubic: function (t) { return (--t)*t*t+1 },
        // acceleration until halfway, then deceleration
        easeInOutCubic: function (t) { return t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1 },
        // accelerating from zero velocity
        easeInQuart: function (t) { return t*t*t*t },
        // decelerating to zero velocity
        easeOutQuart: function (t) { return 1-(--t)*t*t*t },
        // acceleration until halfway, then deceleration
        easeInOutQuart: function (t) { return t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t },
        // accelerating from zero velocity
        easeInQuint: function (t) { return t*t*t*t*t },
        // decelerating to zero velocity
        easeOutQuint: function (t) { return 1+(--t)*t*t*t*t },
        // acceleration until halfway, then deceleration
        easeInOutQuint: function (t) { return t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t }
      }

      var circles = [];
      var radius = 2;
      var baseDistance = 17;
      var count = 7;
      var width = 100;
      var svg = document.getElementById("canvas");
      var overlay = document.getElementById("overlay");
      var zoomedIn = false;
      var colors = [ '#D0011B', '#F6A623', '#F8E81C', '#B8E986', '#50E3C2', '#4990E2', '#9012FE', '#BD0FE1' ];

      var setCircleDistance = function(circle, distance) {
        circle.distance += distance;
        circle.setAttribute('style', 'transform: rotate(' + circle.deg + 'deg) translateX(' + (circle.distance) + 'px) rotate(-' + circle.deg + 'deg);');
      }

      var addCircle = function(deg, color) {
        var circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
        circle.setAttribute('class', 'ball');
        circle.setAttribute('cx', width/2);
        circle.setAttribute('cy', width/2);
        circle.setAttribute('r', radius);
        circle.setAttribute('fill', color);
        circle.deg = deg;
        circle.distance = 0;
        circle.factor = (Math.random() - 0.5);
        setCircleDistance(circle, baseDistance);
        circles.push(circle);
        svg.appendChild(circle);

        var hammer = new Hammer.Manager(circle);
        hammer.add(new Hammer.Pan({threshold: 0, pointers: 0, domEvents: true}));
        hammer.add(new Hammer.Tap({}));
        hammer.on('pan', function(event) {

          if(zoomedIn) {
            return;
          }

          event.srcEvent.stopPropagation();
          event.srcEvent.preventDefault();
          event.preventDefault();
          var svgB = svg.getBoundingClientRect();
          var x = event.center.x - (svgB.width / 2);
          var y = event.center.y - (svgB.height / 2);
          var distance = Math.pow((Math.pow(x, 2) + Math.pow(y, 2)), 0.5) * (1/6.2) - circle.distance;

          setCircleDistance(circle, distance);

          for(let i = 0; i < circles.length; i++) {
            if(circles[i] != circle) {
              setCircleDistance(circles[i], distance  * circles[i].factor);
            }
          }
        });

        hammer.on('tap', function(event){
          if(zoomedIn) {
            closeOverlay();
          } else {
            zoomedIn = true;
            var scroll = document.getElementsByClassName('scroll')[0];
            var b1 = scroll.getBoundingClientRect();
            zoomIn(circle, 0, b1.width/4);
            openOverlay(circle.getAttribute('fill'));
          }
        });
      }

      var zoomIn = function(circle, level, shiftLeft) {
        if(level <= 10) {
          setTimeout(function(){
            zoom(EasingFunctions.easeOutQuad(level/10) * 5);
            var bound = circle.getBoundingClientRect();
            scroll(bound.left, bound.top, shiftLeft, 0);
            zoomIn(circle, level+1, shiftLeft);
            circle.style.opacity = 1;
          }, 1);
        }
      }

      var zoomOut = function(level) {
        if(level <= 10) {
          setTimeout(function(){
            zoom(EasingFunctions.easeOutQuad(level/10) * -5);
            zoomOut(level+1);
            for(let i = 0; i < circles.length; i++) {
              circles[i].style.opacity = "";
            }
          }, 1);
        }
      }

      var zoom = function(level) {
        if((width + level) >= 100 && (width + level) <= 300) {
          width += level;
          svg.setAttribute('width', width + '%');
          svg.setAttribute('height', width + '%');
        }
      }

      var scroll = function(x, y, shiftLeft, shiftTop) {
        var scroll = document.getElementsByClassName('scroll')[0];
        var b1 = scroll.getBoundingClientRect();
        scroll.scrollLeft = scroll.scrollLeft + x - b1.width/2 + shiftLeft;
        scroll.scrollTop = scroll.scrollTop + y - b1.height/2 + shiftTop;
      }

      var getRandomColor = function() {
        var letters = '0123456789ABCDEF';
        var color = '#';
        for (var i = 0; i < 6; i++ ) {
            color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
      }

      var getColor = function(i) {
        return colors[i % colors.length];
      }

      var openOverlay = function(color) {
        overlay.classList.add('open');
        overlay.getElementsByTagName('h2')[0].style.color = color;
        svg.classList.add('open');
      }

      var closeOverlay = function() {
        overlay.classList.remove('open');
        svg.classList.remove('open');
        zoomedIn = false;
        zoomOut(0);
      }


      window.onload = function(){
        var circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
          circle.setAttribute('cx', width/2);
          circle.setAttribute('cy', width/2);
          circle.setAttribute('r', 1);
          circle.setAttribute('fill', '#efefef');
          circle.setAttribute('stroke', '#dedede');
          circle.setAttribute('stroke-width', 0.10);
          svg.appendChild(circle);

        for(var i = 0; i <= count; i++) {
          addCircle(i * (360/(count+1)), getColor(i));
        }
      }
  </script>
</body>
</html>
